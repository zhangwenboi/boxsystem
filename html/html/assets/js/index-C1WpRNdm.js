import{j as e,P as R,a as w,b as T,c as d,M as L,d as S,W as F,e as O,S as m,f as z}from"./@ant-design/pro-components-wrAZwqBS.js";import{az as B,r as l,C as E,s as H,B as M,V as x,j as v}from"./antd-CYONuGoU.js";import{l as N}from"./@ant-design/icons-BZ6uQQrX.js";import{O as D,f as I,g as f,a as _}from"./react-router-DnoTb2US.js";import{L as A,H as q}from"./react-router-dom-Bgq8UBOM.js";import{e as $}from"./umi-request-D9SuV8l8.js";import{R as k}from"./rc-resize-observer-Cu_UjwVV.js";import{_ as Y}from"./react-countup-BAON_YH9.js";import{L as K}from"./@ant-design/charts-D8N_lJ8b.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();var h={},g=B;h.createRoot=g.createRoot,h.hydrateRoot=g.hydrateRoot;const G={route:{path:"/",routes:[{path:"/home",name:"欢迎",icon:e.jsx(N,{}),component:"./home"}]},location:{pathname:"/"}},U=()=>{const[t,s]=l.useState("/home");return typeof document>"u"?e.jsx("div",{}):e.jsx("div",{id:"test-pro-layout",style:{height:"100vh",overflow:"auto"},children:e.jsx(R,{hashed:!1,children:e.jsx(E,{getTargetContainer:()=>document.getElementById("test-pro-layout")||document.body,children:e.jsx(w,{prefixCls:"my-prefix",...G,location:{pathname:t},token:{header:{colorBgMenuItemSelected:"rgba(0,0,0,0.04)"}},siderMenuType:"group",menu:{collapsedShowGroupTitle:!0},title:"系统信息",menuItemRender:(i,n)=>e.jsx("div",{onClick:()=>{s(i.path||"/home")},children:n}),children:e.jsx(T,{token:{paddingInlinePageContainerContent:20},subTitle:"下行盒子拉取查看",children:e.jsx(D,{})})})})})})},W=()=>e.jsx(H,{status:"404",title:"404",subTitle:"哦吼,找不到页面了!",extra:e.jsx(A,{to:"/",children:e.jsx(M,{type:"primary",children:"返回首页"})})}),V={200:"服务器成功返回请求的数据。",201:"新建或修改数据成功。",202:"一个请求已经进入后台排队（异步任务）。",204:"删除数据成功。",400:"发出的请求有错误，服务器没有进行新建或修改数据的操作。",401:"用户没有权限（令牌、用户名、密码错误）。",403:"用户得到授权，但是访问是被禁止的。",404:"发出的请求针对的是不存在的记录，服务器没有进行操作。",406:"请求的格式不可得。",410:"请求的资源被永久删除，且不会再得到的。",422:"当创建一个对象时，发生一个验证错误。",500:"服务器发生错误，请检查服务器。",502:"网关错误。",503:"服务不可用，服务器暂时过载或维护。",504:"网关超时。"},J=t=>{if(t.request.options.responseType==="blob")return t;const{response:s}=t;if(s&&s.status){const i=V[s.status]||s.statusText,{status:n,url:r}=s;let o=r;r.indexOf("?")!==-1&&(o=r.substring(0,r.indexOf("?"))),x.error(`请求错误 [${n}]: ${o}${i}`)}else s||x.error("您的网络发生异常，无法连接服务器");return s},p=$({errorHandler:J,credentials:"include"});p.interceptors.response.use(async(t,s)=>{if(s.responseType==="blob")return t;const{status:i}=t;return i===500&&x.error({content:"网络错误"}),t});const Q=async t=>await new Promise(s=>{setTimeout(()=>{s(!0)},t)}),X=t=>{if(t){const s=(t==null?void 0:t.split(/\ /g))||[0,"KB"];return e.jsx(Y,{end:s[0],suffix:s[1],separator:",",decimals:2})}return"0KB"},Z=()=>{var j;const[t,s]=l.useState(),[i,n]=l.useState(1920),[r,o]=l.useState([]),c=async()=>{const a=await p.get("/api/system_status");a.code===1e3&&s(a.data)};l.useEffect(()=>{c()},[]);const b=(j=r==null?void 0:r[0])==null?void 0:j.rx,P=[{title:"日期",dataIndex:"day"},{title:"下载",dataIndex:"rx"},{title:"平均速率",dataIndex:"avg"}],C=r==null?void 0:r.reduce((a,u)=>{var y;return a+Number((y=u.rx.match(/\d+\.\d+/g))==null?void 0:y[0])},0);return e.jsx("div",{children:e.jsx(k,{onResize:a=>{n(a.width)},children:e.jsxs(d,{title:"数据概览",extra:e.jsxs(e.Fragment,{children:[e.jsxs(L,{title:"设置运行时间",layout:"horizontal",width:i<596?"80%":"60%",trigger:e.jsx("a",{className:"mx-2",children:" 设置 "}),onFinish:async a=>{const u=await p.post("/api/system-exec-time-piker",{data:a});x.success(u.data)},submitter:{render(a,u){return e.jsx("div",{className:" flex gap-x-2 justify-center w-full ",children:u})}},children:[e.jsx(S,{name:["repeat"],children:({repeat:a})=>e.jsx(F.RangePicker,{rules:a?[]:[{required:!0}],tooltip:"只会在此时间段内运行",name:"time",disabled:a,label:"运行时间",fieldProps:{format:"HH:mm"}})}),e.jsx(O,{name:"repeat",label:"持续运行",tooltip:"开启后将全天运行",fieldProps:{checkedChildren:"开启",unCheckedChildren:"关闭"}})]}),v().format("YYYY-MM-DD HH:mm:ss")]}),split:i<1280?"horizontal":"vertical",headerBordered:!0,bordered:!0,children:[e.jsxs(d,{split:"horizontal",children:[e.jsxs(d,{split:"horizontal",children:[e.jsxs(d,{split:i<596?"horizontal":"vertical",children:[e.jsx(m,{statistic:{title:"今日下载",value:b,precision:3,formatter:X}}),e.jsx(m,{statistic:{title:"近30日流量",value:C,suffix:"GB",precision:2}})]}),e.jsxs(d,{split:"vertical",children:[e.jsx(m,{statistic:{title:"内存占用",value:(t==null?void 0:t.memory_used_percent)||0,precision:2,suffix:"%"}}),e.jsx(m,{statistic:{title:"CPU占用",value:`${(t==null?void 0:t.cpu_percent)||0}`,suffix:"%",precision:2}})]})]}),e.jsx(z,{toolbar:{title:"近日流量"},options:i>596?!1:{density:!0,fullScreen:!0,reload:!0},tooltip:"数据更新有延迟，仅供参考",request:async()=>{const a=await p.get("/api/month_info");return a.code===1e3?(o(a.data),{data:a.data,success:!0}):{data:[],success:!1}},search:!1,columns:P,pagination:{hideOnSinglePage:!0}})]}),e.jsx(ee,{})]})},"resize-observer")})},ee=()=>e.jsx(m,{title:"流量走势",extra:!1,chart:e.jsx(te,{})}),te=()=>{const[t,s]=l.useState([]);l.useEffect(()=>{const n=async()=>{const r=await p.get("/api/network_speed");r.code===1e3&&(s(o=>[...o,{label:v().format("HH:mm:ss"),value:Number(r.data)}]),await Q(2e3),n())};n()},[]);const i={data:t||[],xField:"label",yField:"value",yAxis:{label:{formatter:n=>`${n}MB`}},tooltip:{title:"下载速度",formatter:n=>({name:n.label,value:n.value})},color:["#1979C9","#D62A0D","#FAA219"],smooth:!0,animation:!1};return e.jsx(K,{...i})};function re({to:t}){let s=_();return l.useEffect(()=>{s(t)}),null}const se=t=>e.jsx(l.Suspense,{children:t});function oe(){return l.useEffect(()=>{var t;(t=document.querySelector("#index-loading"))==null||t.remove()},[]),e.jsx(I,{children:e.jsxs(f,{path:"/",element:e.jsx(U,{}),children:[e.jsx(f,{path:"NotFound",element:e.jsx(W,{})}),e.jsx(f,{index:!0,element:se(e.jsx(Z,{}))}),e.jsx(f,{path:"*",element:e.jsx(re,{to:"NotFound"})})]})})}h.createRoot(document.getElementById("root")).render(e.jsx(q,{children:e.jsx(oe,{})}));
